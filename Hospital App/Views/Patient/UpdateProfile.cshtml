@model Hospital_App.Models.Patient
@{
    ViewData["Title"] = "Update Profile";
    Layout = "~/Views/Shared/_PatientLayout.cshtml";
}
<div class="row">
    <ol class="breadcrumb">
        <li>
            <a href="#">
                <em class="fa fa-home"></em>
            </a>
        </li>
        <li class="active">Settings</li>
        <li class="active">Update Profile</li>
    </ol>
</div>
<div class="container px-6 mx-auto grid">

    <h2><b>@ViewData["Title"]</b></h2>


        <form method="post" asp-action="UpdateProfile">
            <div class="form-horizontal">

            @if (ViewBag.message != null)
            {
                <h5 class="alert alert-success">@ViewBag.message</h5>
            }
            <input asp-for="ApplicationUserId" hidden />

            <div asp-validation-summary="All" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="FirstName" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="FirstName" class="form-control" title="Enter your name"/>
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>
            </div>

            <div asp-validation-summary="All" class="text-danger"></div>
            <div class="form-group">
                <label asp-for="Surname" class="required control-label col-md-2"  ></label>
                <div class="col-md-10">
                    <input asp-for="Surname" class="form-control" title="Enter your surname" />
                    <span asp-validation-for="Surname" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="IDNumber" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="IDNumber" class="form-control" onchange="calculateDateOfBirth()" id="IDNumber" title="Enter your ID Number"/>
                    <span asp-validation-for="IDNumber" class="text-danger"></span>
                </div>
            </div>
            <div class="form-group">
                <label asp-for="DateOfBirth" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="DateOfBirth" class="form-control" type="date" title="Enter your date of birth"/>
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="ContactNumber" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="ContactNumber" class="form-control" title="Enter your Contact Number"/>
                    <span asp-validation-for="ContactNumber" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="EmergencyContatctPerson" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="EmergencyContatctPerson" class="form-control" title="Enter Emegerncy Contact Person name"/>
                    <span asp-validation-for="EmergencyContatctPerson" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="EmergencyNumber" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <input asp-for="EmergencyNumber" class="form-control" title="Enter Emegency Contact number"/>
                    <span asp-validation-for="EmergencyNumber" class="text-danger"></span>
                </div>
            </div>

            <div class="form-group">
                <label asp-for="Gender" class="required control-label col-md-2"></label>
                <div class="col-md-10">
                    <select asp-for="Gender" class="form-control">
                        <option value="">Select Gender</option>
                        <option value="Male">Male</option>
                        <option value="Female">Female</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">Update</button>

            </div>
        </form>
    </div>


<script>
    function calculateDateOfBirth() {
        var idNumber = document.getElementById('IDNumber').value;
        var dateOfBirthInput = document.getElementById('DateOfBirth');
        if (idNumber.length === 13) {
            var year = idNumber.substring(0, 2);
            var month = idNumber.substring(2, 4);
            var day = idNumber.substring(4, 6);

            if (parseInt(month) > 12) {
                year = '20' + year;
                month = (parseInt(month) - 20).toString();
            } else {
                year = '19' + year;
            }

            var dateOfBirth = year + '-' + month + '-' + day;

            if (dateOfBirth !== dateOfBirthInput.value) {
                alert('Date of birth does not match the ID number.');
                dateOfBirthInput.value = dateOfBirth; 
            } 
            
        }
    }
</script>

